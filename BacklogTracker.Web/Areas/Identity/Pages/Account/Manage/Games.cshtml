@page
@model GamesModel
@{
	ViewData["Title"] = "Games";
	ViewData["ActivePage"] = ManageNavPages.Games;

	var games = Model.Backlog?.Games;
	var completedGames = Model.CompletedGames?.Games;
	var user = Model.User.Identity;
}

<h3 class="page-section-title">@ViewData["Title"]</h3>
<p class="subtle-muted mb-3">Manage your current backlog and celebrate the games you have finished.</p>
<div id="errorMessage"></div>


@section Scripts {
	<partial name="_ValidationScriptsPartial" />
}

<div>
	@if (games != null && games.Any())
	{

		<ul class="games-list">

			@foreach (var game in games)
			{
				<li class="backlog-item">
					<a href="@game.Url" target="_blank">@game.Name</a>
					<div class="backlog-btn d-flex gap-2">
						<button type="button" class="btn btn-success btn-sm px-3" data-completed-game-id="@game.Id" onclick="addToCompleted(this,'@user?.Name?.Trim()')" aria-label="Mark as completed">✓</button>
						<button type="button" class="btn btn-danger btn-sm px-3" data-game-id="@game.Id" onclick="removeFromBacklog(this,'@user?.Name?.Trim()')" aria-label="Remove from backlog">X</button>
					</div>
				</li>
			}
		</ul>

	}
	else
	{
		<p>It appears you haven't added any games to your backlog!</p>
	}
</div>

<h3 class="page-section-title mt-4">Completed Games</h3>
<div>
	@if (completedGames != null && completedGames.Any())
	{

		<ul class="games-list">

			@foreach (var game in completedGames)
			{
				<li class="backlog-item">
					<a href="@game.Url" target="_blank">@game.Name</a>
					<div class="backlog-btn">
						<button type="button" class="btn btn-warning" data-game-id="@game.Id" onclick="moveFromCompletedTobacklog(this,'@user?.Name?.Trim()')" )>Backlog</button>
					</div>
				</li>
			}
		</ul>

	}
	else
	{
		<p>It appears you haven't completed any games!</p>
	}
</div>